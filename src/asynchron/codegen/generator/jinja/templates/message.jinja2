{# @formatter:off #}
{% extends "base/python_module.jinja2" %}

{% macro render_python_type_name(type) -%}
    {%- if type.module and type.module.path and type.module.path != ("builtins",) -%}
        {%- if type.module.alias -%}
            {{ type.module.alias }}
        {%- else -%}
            {{ type.module.path|join(".") }}
        {%- endif -%}
        .
    {%- endif -%}
    {%- if type.module -%}
        {{ type.path|join(".") }}
    {%- else -%}
        {{ type.path|pascalcase|join("") }}
    {%- endif -%}
{%- endmacro %}

{% macro render_python_type(type) -%}
    {{ render_python_type_name(type) }}
    {%- if type.type_parameters -%}
        [
        {%- for type_parameter in type.type_parameters -%}
            {{ render_python_type(type_parameter) }}
            {%- if not loop.last %}, {% endif -%}
        {%- endfor -%}
        ]
    {%- endif -%}
{%- endmacro %}

{% macro render_field_info(field) -%}
    {%- if field.default
                or field.alias
                or field.title
                or field.description
                or field.const
                or field.gt
                or field.ge
                or field.lt
                or field.le
                or field.multiple_of
                or field.min_items
                or field.max_items
                or field.min_length
                or field.max_length
                or field.allow_mutation
                or field.regex -%}
    Field(
        {% if field.default %}
        default={{ field.default|python_expr }},
        {% endif %}
        {% if field.alias %}
        alias="{{ field.alias }}",
        {% endif %}
{#        {% if field.title %}#}
{#        title="""{{ field.title }}""",#}
{#        {% endif %}#}
        {% if field.description %}
        description="""{{ field.description }}""",
        {% endif %}
{#        {% if field.const %}#}
{#        const={{ field.const }},#}
{#        {% endif %}#}
        {% if field.gt %}
        gt={{ field.gt }},
        {% endif %}
        {% if field.ge %}
        ge={{ field.ge }},
        {% endif %}
        {% if field.lt %}
        lt={{ field.lt }},
        {% endif %}
        {% if field.le %}
        le={{ field.le }},
        {% endif %}
        {% if field.multiple_of %}
        multiple_of={{ field.multiple_of }},
        {% endif %}
        {% if field.min_items %}
        min_items={{ field.min_items }},
        {% endif %}
        {% if field.max_items %}
        max_items={{ field.max_items }},
        {% endif %}
        {% if field.min_length %}
        min_length={{ field.min_length }},
        {% endif %}
        {% if field.max_length %}
        max_length={{ field.max_length }},
        {% endif %}
        {% if field.allow_mutation %}
        allow_mutation={{ field.allow_mutation|python_expr }},
        {% endif %}
        {% if field.regex %}
        regex=r"""{{ field.regex }}""",
        {% endif %}
    )
    {%- else -%}
        Field()
    {%- endif %}
{%- endmacro %}


{% macro render_python_class_bases(bases) -%}
    {% if bases -%}
        (
        {%- for base in bases -%}
            {{ render_python_type(base) }}
            {%- if not loop.last %}, {% endif -%}
        {%- endfor -%}
        )
    {%- endif %}
{%- endmacro %}

{% block imports %}
    {% for import in imports|unique %}
        {% if import.path != ("builtins",) %}
import {{ import.path|join(".") }}{% if import.alias %} as {{ import.alias }}{% endif %}

        {% endif %}
    {% endfor %}
{% endblock %}

{% block classes %}
    {% for class in classes %}
class {{ class.path|pascalcase|join("") }}{{ render_python_class_bases(class.bases) }}:
        {% if class.descrition %}
    """{{ class.description }}"""
        {% endif %}
        {% if class.fields %}
            {% for field in class.fields|sorted(attribute="name") %}
    {{ field.name|snakecase }}: {{ render_python_type(field.of_type) }} = {{ render_field_info(field.info) }}
            {% endfor %}
{#        {% elif class.literals %}#}
{#            {% for literal in class.literals %}#}
{#    {{ literal.name|constcase }} = {{ literal.expr.value }}#}
{#            {% endfor %}#}
        {% else %}
    pass
        {% endif %}


    {% endfor %}
{% endblock %}
{# @formatter:on #}
